<!DOCTYPE html>
<html>
<head>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      liff.init({ liffId: '2007879229-w3ZOJvm6' }).then(() => {
        if (!liff.isLoggedIn()) {
          liff.login();
        } else {
          liff.getProfile().then(profile => {
            const userId = profile.userId;
            fetch('GASのWebアプリURL?userId=' + userId)
              .then(res => res.json())
              .then(data => {
                if (data.showForm) {
                  document.getElementById('formContainer').style.display = 'block';
                }
              });
          });
        }
      });
    });
  </script>
</head>
<body>
  <div id="formContainer" style="display:none;">
    <form id="userForm">
      <label>性別：<input name="gender" /></label><br>
      <label>年代：<input name="age_range" /></label><br>
      <label>居住エリア：<input name="area" /></label><br>
      <label><input type="checkbox" name="agree" required /> 利用に同意する</label><br>
      <button type="submit">登録</button>
    </form>
  </div>
</body>
</html>
